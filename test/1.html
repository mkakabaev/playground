<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Deeplinking test</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no" />

<style>
body {
    font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    margin: 20pt;
    font-size: 14pt;
}
h1 {
    font-size: 18pt;
} 
input {
    font-size: 12pt;
}
td {
    padding-right: 18pt;
} 

.input_box {
    padding: 4px;
}
</style>
</head>

<body>

<script>

    // fill the schema

    document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(document.location.search);

        for (const key of ['schema', 'facebook', 'af']) { 
            const value = urlParams.get(key);
            input = document.getElementById(key);        
            input.value = value
        }
    });

    function getSchema() {
        return document.getElementById('schema').value
    }

    function openAF(command, params) {
        af = document.getElementById('af').value
        window.open(af + '/' + command + '?deep_link_sub1=' + params);
    }

    function getFacebookAppId() {
        return document.getElementById('facebook').value
    }

    function userApproved() {
        schema = getSchema()
        window.open(schema + '://user-approved');
        return false;
    }

    function resetPassword() {
        schema = getSchema()
        token = document.getElementById('reset_password_token').value
        window.open(schema + '://reset-password?token=' + token);
        return false;
    }
    
    function openFacebook() {
        appId = getFacebookAppId()
        window.open('fb' + appId + '://');
        return false;
    }

    function verifyCode() {
        schema = getSchema()
        code = document.getElementById('verify_code').value
        window.open(schema + '://verify-code?code=' + code);
        return false;
    }

    function emptySchema() {
        schema = getSchema()
        window.open(schema + '://');
        return false;
    }

    function openDocument(method) {
        id = document.getElementById('document_id').value
        switch (method) {
            case 'af': openAF('opendoc', id ); break;
            default: window.open(getSchema() + '://open-document?id=' + id);
        }
        return false;        
    }

    function openConsultation() {
        schema = getSchema()
        id = document.getElementById('document_id').value
        window.open(schema + '://consultation-message?document_id=' + id);
        return false;        
    }

</script>

<div class="input_box">
    <label>AF Postfix</label>
    <input 
        name="af" id="af" type="text" 
        class="textfield" value="af_url" size="25" maxlength="80" 
    />
</div>

<div class="input_box">
    <label>Schema</label>
    <input 
        name="schema" id="schema" type="text" 
        class="textfield" value="schema" size="25" maxlength="80" 
    />
</div>

<div class="input_box">
    <label>Facebook App Id</label>
    <input 
        name="facebook" id="facebook" type="text" 
        class="textfield" value="facebook" size="25" maxlength="80" 
    />
</div>

<div class="input_box">
    <label>Reset password token</label>
    <input 
        name="reset_password_token" id="reset_password_token" type="text" 
        class="textfield" value="THE_TOKEN" size="25" maxlength="80" 
    />
</div>

<div class="input_box">
    <label>Verify registration code</label>
    <input 
        name="verify_code" id="verify_code" type="text" 
        class="textfield" value="12345" size="25" maxlength="25" 
    />
</div>

<div class="input_box">
    <label>Document ID</label>
    <input 
        name="document_id" id="document_id" type="text" 
        class="textfield" value="123" size="25" maxlength="80" 
    />
</div>    

<h1>Commands</h1>
<table>
<tr>
    <td>Open Document</td>
    <td><a href="#", onClick="openDocument();" >Custom</a></td>
    <td><a href="#", onClick="openDocument('af');" >AF</a></td>
</tr>
</table>
<p><a href="link", onClick="emptySchema();" >Just schema</a></p>
<p><a href="link", onClick="resetPassword();" >Reset Password</a></p>
<p><a href="link", onClick="openDocument();" > Open Document</a></p>
<p><a href="link", onClick="openConsultation();" > Open Consultation</a></p>
<p><a href="link", onClick="verifyCode();" >Verify Code</a></p>
<p><a href="link", onClick="userApproved();" >User Approved</a></p>
<p><a href="link", onClick="openFacebook();" >Open using FaceBook</a></p>

</body>
</html>


